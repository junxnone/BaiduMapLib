!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).MapGeo=e()}(this,function(){"use strict";function p(t,e){var n=e.onclick,r=e.ondblclick,o=e.dbldel,a=e.confirmdel;n&&"function"==typeof n&&t.addEventListener("click",function(t){n.call(this,t)}),o&&(r=function(t){if(a&&confirm("确认删除？"))return this.map.removeOverlay(this),!1;a||this.map.removeOverlay(this)}),r&&"function"==typeof r&&t.addEventListener("dblclick",function(t){r.call(this,t)})}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(o){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},e=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),e.forEach(function(t){var e,n,r;e=o,r=a[n=t],n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r})}return o}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e,n){return(s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&i(o,n.prototype),o}).apply(null,arguments)}function c(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}BMap.Layer=function(t,e){this.overlays=[],this.name=e,(this.map=t).layers[e]=this},BMap.Layer.prototype.add=function(t){this.overlays.push(t)},BMap.Layer.prototype.remove=function(t){},BMap.Layer.prototype.clear=function(){var e=this.map;this.overlays.forEach(function(t){e.removeOverlay(t)}),this.overlays=[]},BMap.Overlay.prototype.enableDoubleClickDel=function(){p(this,{dblclick:!0})},BMap.Overlay.prototype.addToLayer=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:DEFAULT_FEATURE_NAME,e=this.map.layers[t];return e||(e=new BMap.Layer(this.map,t)),(this.layer=e).add(this),this},BMap.Overlay.prototype.toGeoJson=function(){var e={type:"",coordinates:[]},t={type:"Feature",properties:{},geometry:e};if(this instanceof BMap.Polygon&&(e.type="Polygon",e.coordinates=[[]],this.getPath().forEach(function(t){e.coordinates[0].push([t.lng,t.lat])})),this instanceof BMap.Polyline&&(e.type="LineString",this.getPath().forEach(function(t){e.coordinates.push([t.lng,t.lat])})),this instanceof BMap.Marker){e.type="Point";var n=this.getPosition(),r=n.lng,o=n.lat;e.coordinates=[r,o]}return t},BMap.RenderMapV=function(t,e){if(!mapv)return console.error("At first, needs mapv!"),!1;this.overlays=[],this.type="mapv",this.map=t,this.dataSet=new mapv.DataSet(e);this.mapvLayer=new mapv.baiduMapLayer(t,this.dataSet,{strokeStyle:"green",fillStyle:"rgba(0,0,0,.3)",shadowBlur:0,methods:{click:null},lineWidth:3,draw:"webgl"}),this.mapvLayer.canvasLayer.map=t,this.mapvLayer.canvasLayer.canvas.classList.add("constructMap")};BMap.Point;var y={name:"tmp",prop:{},styleMap:{},renderer:"svg"};BMap.Point.fromArray=function(t){return s(BMap.Point,c(t))},BMap.Map.prototype.setCenter2=function(t,e){var n;n=Array.isArray(t)?s(BMap.Point,c(t)):t,e||(e=this.getZoom()),this.setCenter(n,e)},BMap.Map.prototype.addPoint=function(t){var e=s(BMap.Point,c(t)),n=new BMap.Marker(e);this.addOverlay(n);var r=this;return n.addEventListener("dblclick",function(t){r.removeOverlay(this)}),n},BMap.Map.prototype.addTmpPoint=function(t){var e=s(BMap.Point,c(t));return this.tmpMk?this.tmpMk.setPosition(e):this.tmpMk=this.addPoint(t),this.tmpMk},BMap.Map.prototype.layers={};var u={strokeColor:"red",strokeWeight:4,strokeOpacity:.5},f={strokeColor:"blue",fillColor:"blue",strokeWeight:2,fillOpacity:.8},d={};BMap.Map.prototype.polygon=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:y,n=t[0].map(function(t){return s(BMap.Point,c(t))}),r=l({},f,e.styleMap.polygon),o=new BMap.Polygon(n,r);this.addOverlay(o);var a=e.name,i=e.prop;return o.prop=i,o.addToLayer(a),p(o,e),o},BMap.Map.prototype.polyline=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:y,n=t.map(function(t){return s(BMap.Point,c(t))}),r=l({},u,e.styleMap.polyline),o=new BMap.Polyline(n,r);this.addOverlay(o);var a=e.name,i=e.prop;return o.prop=i,o.addToLayer(a),p(o,e),o},BMap.Map.prototype.point=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:y,n=s(BMap.Point,c(t)),r=l({},d,e.styleMap.point),o=new BMap.Marker(n,r);this.addOverlay(o);var a=e.name,i=e.prop;return o.prop=i,o.addToLayer(a),p(o,e),o},BMap.Map.prototype.addFeature=function(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:y,r=t.geometry,o=r.type,a=(n.name,r.coordinates);return"Polygon"===o&&(e=this.polygon(a,n)),"LineString"===o&&(e=this.polyline(a,n)),"Point"===o&&(e=this.point(coordinatesm,n)),e},BMap.Map.prototype.geoJSON=function(t){var e=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:y;try{if("mapv"===n.render)return new BMap.RenderMapV(this,t).mapvLayer.canvasLayer.addToLayer(n.name);var r,o="object"!==a(t)?JSON.parse(t):t;return"FeatureCollection"===o.type&&(r=[],o.features.forEach(function(t){r.push(e.addFeature(t,n))})),Array.isArray(o)&&(r=[],o.forEach(function(t){r.push(e.addFeature(t,n))})),"Feature"===o.type&&(r=this.addFeature(o,n)),"Polygon"===o.type&&(r=this.polygon(o.coordinates,n)),"LineString"===o.type&&(r=this.polyline(o.coordinates,n)),"Point"===o.type&&(r=this.point(o.coordinates,n)),r}catch(t){return console.log(t),null}},BMap.Map.prototype.getMbr=function(){var t=this.getBounds(),e=t.getSouthWest(),n=e.lng,r=e.lat,o=t.getNorthEast();return{xmin:n,xmax:o.lng,ymin:r,ymax:o.lat}};return{}});