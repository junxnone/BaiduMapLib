!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).MapGeo=e()}(this,function(){"use strict";var o=0;function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(a){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},e=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),e.forEach(function(t){var e,r,n;e=a,n=o[r=t],r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n})}return a}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t,e,r){return(y=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var a=new(Function.bind.apply(t,n));return r&&i(a,r.prototype),a}).apply(null,arguments)}function c(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(t,e){var r=e.onclick,n=e.ondblclick,a=e.dbldel,o=e.confirmdel;r&&"function"==typeof r&&t.addEventListener("click",function(t){r.call(this,t)}),a&&!n&&(n=function(t){if(o&&confirm("确认删除？"))return this.map.removeOverlay(this),!1;o||this.map.removeOverlay(this)}),n&&"function"==typeof n&&t.addEventListener("dblclick",function(t){var e,r;n.call(this,t),(r=e=t,e=window.event||r).stopPropagation?e.stopPropagation():e.cancelBubble=!0})}BMap.Layer=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.id=o++,this.overlays=[];var r=e.name,n=e.alias,a=e.displayInSwitcher;this.name=r||"Layer".concat(this.id),this.displayInSwitcher=!0,"displayInSwitcher"in e&&(this.displayInSwitcher=a),n&&(this.alias=n),(this.map=t).layers[r]=this},BMap.Layer.prototype.add=function(t){this.overlays.push(t)},BMap.Layer.prototype.hide=function(t){this.overlays.forEach(function(t){return t.hide()})},BMap.Layer.prototype.show=function(t){this.overlays.forEach(function(t){return t.show()})},BMap.Layer.prototype.remove=function(t){this.map.removeOverlay(t),this._updateIndex(t)},BMap.Layer.prototype._updateIndex=function(e){this.overlays=this.overlays.filter(function(t){return t!==e})},BMap.Layer.prototype.clear=function(){var e=this.map;this.overlays.forEach(function(t){e.removeOverlay(t)}),this.overlays=[]};BMap.Overlay.prototype.enableDoubleClickDel=function(){u(this,s({dbldel:!0},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{confirmdel:!0}))},BMap.Overlay.prototype.addToLayer=function(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{name:"tmp",alias:""};if(e instanceof BMap.Layer)t=e;else{var r=e.name;e.alias;(t=this.map.layers[r])||(t=new BMap.Layer(this.map,e))}return(this.layer=t).add(this),this},BMap.Overlay.prototype.toGeoJSON=function(){var e={type:"",coordinates:[]},t={type:"Feature",properties:{},geometry:e};if(this instanceof BMap.Polygon&&(e.type="Polygon",e.coordinates=[[]],this.getPath().forEach(function(t){e.coordinates[0].push([t.lng,t.lat])})),this instanceof BMap.Polyline&&(e.type="LineString",this.getPath().forEach(function(t){e.coordinates.push([t.lng,t.lat])})),this instanceof BMap.Marker){e.type="Point";var r=this.getPosition(),n=r.lng,a=r.lat;e.coordinates=[n,a]}return t},BMap.RenderMapV=function(t,e,r){this.type="mapv",this.map=t,this.dataSet=new mapv.DataSet(e);var n=r,a=n.name,o=(n.prop,n.renderOption),i=n.styleMap;r=Object.assign({},BMap.RenderMapV.DEFAULT_OPTION,o,i),this.layer=new mapv.baiduMapLayer(t,this.dataSet,r);var p=this.layer.canvasLayer;p.map=t,p.addToLayer({name:a}),(p.layer.render=this).overlays=[p],a&&p.canvas.classList.add(a)},BMap.RenderMapV.prototype.update=function(t){this.dataSet.set(t)},BMap.RenderMapV.DEFAULT_OPTION={strokeStyle:"green",fillStyle:"rgba(255,255,255,0.5)",shadowBlur:0,methods:{click:null},lineWidth:3,draw:"simple"};BMap.Point;var d={name:"tmp",prop:{},styleMap:{},renderer:"svg"};BMap.Point.fromArray=function(t){return y(BMap.Point,c(t))},BMap.Map.prototype.setCenter2=function(t,e){var r;r=Array.isArray(t)?y(BMap.Point,c(t)):t,e||(e=this.getZoom()),this.setCenter(r,e)},BMap.Map.prototype.addPoint=function(t){var e=y(BMap.Point,c(t)),r=new BMap.Marker(e);this.addOverlay(r);var n=this;return r.addEventListener("dblclick",function(t){n.removeOverlay(this)}),r},BMap.Map.prototype.addTmpPoint=function(t){var e=y(BMap.Point,c(t));return this.tmpMk?this.tmpMk.setPosition(e):this.tmpMk=this.addPoint(t),this.tmpMk},BMap.Map.prototype.layers={};var p={strokeColor:"red",strokeWeight:4,strokeOpacity:.5},f={strokeColor:"blue",fillColor:"blue",strokeWeight:2,fillOpacity:.8},h={};BMap.Map.prototype.polygon=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:d,r=t[0].map(function(t){return y(BMap.Point,c(t))}),n=e.styleMap;e.styleMap.polygon&&(n=e.styleMap.polygon);var a=s({},f,n),o=new BMap.Polygon(r,a);this.addOverlay(o);e.name;var i=e.prop;return o.prop=i,o.addToLayer(e),u(o,e),o},BMap.Map.prototype.polyline=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:d,r=t.map(function(t){return y(BMap.Point,c(t))}),n=e.styleMap;e.styleMap.polyline&&(n=e.styleMap.polyline);var a=s({},p,n),o=new BMap.Polyline(r,a);this.addOverlay(o);e.name;var i=e.prop;return o.prop=i,o.addToLayer(e),u(o,e),o},BMap.Map.prototype.point=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:d,r=y(BMap.Point,c(t)),n=e.styleMap;e.styleMap.point&&(n=e.styleMap.point);var a=s({},h,n),o=new BMap.Marker(r,a);this.addOverlay(o);e.name,e.alias;var i=e.prop;return o.prop=i,o.addToLayer(e),u(o,e),o},BMap.Map.prototype.circle=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:d,r=y(BMap.Point,c(t)),n=e.styleMap;e.styleMap.circle&&(n=e.styleMap.circle);var a=s({},f,n),o=(e.name,e.prop),i=e.radius,p=new BMap.Circle(r,i,a);return this.addOverlay(p),p.prop=o,p.addToLayer(e),u(p,e),p},BMap.Map.prototype.addFeature=function(t){var e,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:d,n=t.geometry,a=n.type,o=(r.name,n.coordinates);return"Polygon"===a&&(e=this.polygon(o,r)),"LineString"===a&&(e=this.polyline(o,r)),"Point"===a&&(e=this.point(o,r)),e},BMap.Map.prototype.geoJSON=function(t){var e=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:d;try{var n=r.name;if("mapv"===r.render){var a,o=this.layers[n];return o?(a=o.render).update(t):a=new BMap.RenderMapV(this,t,r),a.overlays}var i,p="object"!==l(t)?JSON.parse(t):t;return"FeatureCollection"===p.type&&(i=[],p.features.forEach(function(t){i.push(e.addFeature(t,r))})),Array.isArray(p)&&(i=[],p.forEach(function(t){i.push(e.addFeature(t,r))})),"Feature"===p.type&&(i=this.addFeature(p,r)),"Polygon"===p.type&&(i=this.polygon(p.coordinates,r)),"LineString"===p.type&&(i=this.polyline(p.coordinates,r)),"Point"===p.type&&(i=this.point(p.coordinates,r)),i}catch(t){return console.log(t),null}},BMap.Map.prototype.getMbr=function(){var t=this.getBounds(),e=t.getSouthWest(),r=e.lng,n=e.lat,a=t.getNorthEast();return{xmin:r,xmax:a.lng,ymin:n,ymax:a.lat}};return{}});