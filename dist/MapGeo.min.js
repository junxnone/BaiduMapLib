!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).MapGeo=e()}(this,function(){"use strict";function p(t,e){var r=e.onclick,n=e.ondblclick,o=e.dbldel,a=e.confirmdel;r&&"function"==typeof r&&t.addEventListener("click",function(t){r.call(this,t)}),o&&(n=function(t){if(a&&confirm("确认删除？"))return this.map.removeOverlay(this),!1;a||this.map.removeOverlay(this)}),n&&"function"==typeof n&&t.addEventListener("dblclick",function(t){n.call(this,t)})}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(o){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},e=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),e.forEach(function(t){var e,r,n;e=o,n=a[r=t],r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n})}return o}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e,r){return(s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&i(o,r.prototype),o}).apply(null,arguments)}function c(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}BMap.Layer=function(t,e){this.overlays=[],this.name=e,(this.map=t).layers[e]=this},BMap.Layer.prototype.add=function(t){this.overlays.push(t)},BMap.Layer.prototype.remove=function(t){},BMap.Layer.prototype.clear=function(){var e=this.map;this.overlays.forEach(function(t){e.removeOverlay(t)}),this.overlays=[]},BMap.Overlay.prototype.enableDoubleClickDel=function(){p(this,{dblclick:!0})},BMap.Overlay.prototype.addToLayer=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:DEFAULT_FEATURE_NAME,e=this.map.layers[t];return e||(e=new BMap.Layer(this.map,t)),(this.layer=e).add(this),this},BMap.Overlay.prototype.toGeoJSON=function(){var e={type:"",coordinates:[]},t={type:"Feature",properties:{},geometry:e};if(this instanceof BMap.Polygon&&(e.type="Polygon",e.coordinates=[[]],this.getPath().forEach(function(t){e.coordinates[0].push([t.lng,t.lat])})),this instanceof BMap.Polyline&&(e.type="LineString",this.getPath().forEach(function(t){e.coordinates.push([t.lng,t.lat])})),this instanceof BMap.Marker){e.type="Point";var r=this.getPosition(),n=r.lng,o=r.lat;e.coordinates=[n,o]}return t},BMap.RenderMapV=function(t,e){if(!mapv)return console.error("At first, needs mapv!"),!1;this.overlays=[],this.type="mapv",this.map=t,this.dataSet=new mapv.DataSet(e);this.mapvLayer=new mapv.baiduMapLayer(t,this.dataSet,{strokeStyle:"green",fillStyle:"rgba(0,0,0,.3)",shadowBlur:0,methods:{click:null},lineWidth:3,draw:"webgl"}),this.mapvLayer.canvasLayer.map=t,this.mapvLayer.canvasLayer.canvas.classList.add("constructMap")};BMap.Point;var y={name:"tmp",prop:{},styleMap:{},renderer:"svg"};BMap.Point.fromArray=function(t){return s(BMap.Point,c(t))},BMap.Map.prototype.setCenter2=function(t,e){var r;r=Array.isArray(t)?s(BMap.Point,c(t)):t,e||(e=this.getZoom()),this.setCenter(r,e)},BMap.Map.prototype.addPoint=function(t){var e=s(BMap.Point,c(t)),r=new BMap.Marker(e);this.addOverlay(r);var n=this;return r.addEventListener("dblclick",function(t){n.removeOverlay(this)}),r},BMap.Map.prototype.addTmpPoint=function(t){var e=s(BMap.Point,c(t));return this.tmpMk?this.tmpMk.setPosition(e):this.tmpMk=this.addPoint(t),this.tmpMk},BMap.Map.prototype.layers={};var u={strokeColor:"red",strokeWeight:4,strokeOpacity:.5},f={strokeColor:"blue",fillColor:"blue",strokeWeight:2,fillOpacity:.8},d={};BMap.Map.prototype.polygon=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:y,r=t[0].map(function(t){return s(BMap.Point,c(t))}),n=l({},f,e.styleMap.polygon),o=new BMap.Polygon(r,n);this.addOverlay(o);var a=e.name,i=e.prop;return o.prop=i,o.addToLayer(a),p(o,e),o},BMap.Map.prototype.polyline=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:y,r=t.map(function(t){return s(BMap.Point,c(t))}),n=l({},u,e.styleMap.polyline),o=new BMap.Polyline(r,n);this.addOverlay(o);var a=e.name,i=e.prop;return o.prop=i,o.addToLayer(a),p(o,e),o},BMap.Map.prototype.point=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:y,r=s(BMap.Point,c(t)),n=l({},d,e.styleMap.point),o=new BMap.Marker(r,n);this.addOverlay(o);var a=e.name,i=e.prop;return o.prop=i,o.addToLayer(a),p(o,e),o},BMap.Map.prototype.addFeature=function(t){var e,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:y,n=t.geometry,o=n.type,a=(r.name,n.coordinates);return"Polygon"===o&&(e=this.polygon(a,r)),"LineString"===o&&(e=this.polyline(a,r)),"Point"===o&&(e=this.point(a,r)),e},BMap.Map.prototype.geoJSON=function(t){var e=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:y;try{if("mapv"===r.render)return new BMap.RenderMapV(this,t).mapvLayer.canvasLayer.addToLayer(r.name);var n,o="object"!==a(t)?JSON.parse(t):t;return"FeatureCollection"===o.type&&(n=[],o.features.forEach(function(t){n.push(e.addFeature(t,r))})),Array.isArray(o)&&(n=[],o.forEach(function(t){n.push(e.addFeature(t,r))})),"Feature"===o.type&&(n=this.addFeature(o,r)),"Polygon"===o.type&&(n=this.polygon(o.coordinates,r)),"LineString"===o.type&&(n=this.polyline(o.coordinates,r)),"Point"===o.type&&(n=this.point(o.coordinates,r)),n}catch(t){return console.log(t),null}},BMap.Map.prototype.getMbr=function(){var t=this.getBounds(),e=t.getSouthWest(),r=e.lng,n=e.lat,o=t.getNorthEast();return{xmin:r,xmax:o.lng,ymin:n,ymax:o.lat}};return{}});